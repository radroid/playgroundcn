# PlaygroundCn - Cursor Rules

## Project Overview

PlaygroundCn is a **static Next.js playground** for Shadcn UI components. It provides a public, no-login interface where users can browse components, edit example code in real-time using Sandpack, and switch between CSS themes. The entire app is designed for static hosting with no backend, database, or authentication.

## Core Architecture Principles

### 1. Static-First Design
- **Next.js App Router** with `output: 'export'` configured for full static export
- All pages must be statically generatable (use `generateStaticParams` for dynamic routes)
- No server-side rendering dependencies, API routes, or dynamic server features
- Everything runs client-side after static HTML/CSS/JS is served

### 2. Tailwind CSS Model (Critical)
- **Tailwind runs ONLY in the host Next.js app** (sidebar, chrome, UI)
  - Normal Tailwind setup: `tailwind.config.ts`, `app/globals.css` with `@tailwind` directives
  - Tailwind compiles at Next.js build time for the host app's UI
- **Sandpack does NOT run Tailwind**
  - Sandpack previews receive **precompiled CSS strings** from the theme registry
  - Theme registry (`lib/registry/themes.ts`) stores plain CSS strings (no `@tailwind` directives)
  - Each theme's CSS is injected into Sandpack as `/globals.css` content
  - Example code imports `"./globals.css"` to access Tailwind utilities
- **Never** try to run Tailwind compiler inside Sandpack or reference `tailwind.config` in Sandpack files

### 3. No Persistence
- **No localStorage**: Do not persist editor state, theme selection, or any user data
- **No backend/DB**: No API calls, Convex, or database dependencies
- **No auth**: No login, user accounts, or authentication flows
- All edits live only in memory; refreshing the page resets examples to registry defaults

### 4. Component Registry Pattern
- Components are defined in `lib/registry/components.ts` as static data
- Each component entry includes:
  - `id`, `displayName`, `category`, `description`
  - `sandpackTemplate` (e.g., `"react-ts"`)
  - `dependencies` (npm packages needed)
  - `examples: { id, name, code }[]` (TSX code strings)
- Registry is imported and used at build time for static generation

### 5. Multiple Examples Pattern
- **Stacked Sandpacks**: Each example renders as a separate `ComponentPlayground` instance
- Examples are stacked vertically on the component detail page (scroll to see all)
- Each Sandpack instance is independent (isolated editing state)
- All examples share the same theme selection (global theme state)
- Use URL anchors for linking: `<h2 id="example-outline">` → `/component/button#example-outline`

## File Structure Conventions

```
app/
  layout.tsx          # Root layout with sidebar + main content
  page.tsx            # Home page
  component/[id]/page.tsx  # Component detail pages (static)
components/
  Sidebar.tsx         # Navigation sidebar (reads registry)
  ComponentPlayground.tsx  # Sandpack wrapper
  ThemeSelector.tsx   # Theme switcher UI
  ui/                 # Shadcn UI components
lib/
  registry/
    types.ts          # TypeScript types for registry entries
    components.ts     # Component registry data
    themes.ts         # Theme registry (CSS strings)
```

## Sandpack Integration Rules

### ComponentPlayground Props
- Accept: `exampleCode` (string), `template`, `dependencies`, `globalsCss` (CSS string), `title`
- Files map must include:
  - `/App.tsx` - Editable example code
  - `/index.tsx` - Entry file that imports `"./globals.css"` and renders `<App />`
  - `/globals.css` - Theme CSS string (plain CSS, no Tailwind directives)
- Use `react-ts` template by default
- Layout: inline editor + preview (side-by-side desktop, stacked mobile)

### Theme Injection
- Theme selector updates global state (component page level)
- Selected theme's `css` string is passed to all `ComponentPlayground` instances
- When theme changes, update Sandpack's `/globals.css` file content
- CSS is already compiled, so Sandpack just applies it as-is

## Code Style & Patterns

- **TypeScript**: Use strict types, define registry entry types explicitly
- **Client Components**: Mark components using hooks/state as `"use client"`
- **Next.js Navigation**: Use `next/navigation` hooks (`usePathname`, `useRouter`) for routing
- **Responsive Design**: Use Tailwind utilities for responsive layouts
- **Accessibility**: Include ARIA labels, keyboard navigation, focus states

## Development Workflow

- **Step-by-step validation**: Implement and validate each step before moving to the next
- **Static export testing**: After major changes, verify `next build` produces valid static output
- **No premature optimization**: Keep it simple; add enhancements only after core features work

## What NOT to Do

- ❌ Don't add backend/API routes or database dependencies
- ❌ Don't add localStorage or any persistence layer
- ❌ Don't try to run Tailwind inside Sandpack
- ❌ Don't use server-only Next.js features (dynamic routes without static generation)
- ❌ Don't add authentication or user accounts
- ❌ Don't create tabs for examples (use stacked Sandpacks instead)
- ❌ Don't persist editor state across page refreshes

## Key Dependencies

- `next` (App Router, static export)
- `@codesandbox/sandpack-react` (inline code editor/preview)
- `shadcn/ui` components (via CLI setup)
- `tailwindcss` (host app only)
- `lucide-react` (icons)
- `class-variance-authority`, `tailwind-merge` (Shadcn utilities)

## Testing Checklist

Before considering a step complete:
1. Component pages load without errors
2. Sandpack previews render correctly
3. Code editing updates preview in real-time
4. Theme switching changes styles in all Sandpack instances
5. Multiple examples display as stacked Sandpacks
6. URL anchors work for linking to specific examples
7. Static export (`next build`) succeeds
8. Exported build runs locally without server dependencies

